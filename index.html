<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RockClan Records</title>

  <!-- âœ… React / ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>

  <!-- âœ… PropTypes (ì „ì—­ ì£¼ì…: Rechartsë³´ë‹¤ ë°˜ë“œì‹œ ë¨¼ì € ë¡œë“œ) -->
  <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js" defer></script>

  <!-- âœ… ì•ˆì • ë²„ì „ Recharts (ë²„ê·¸ íšŒí”¼) -->
  <script src="https://cdn.jsdelivr.net/npm/recharts@2.10.3/umd/Recharts.min.js" defer></script>

  <!-- favicon 404 ì–µì œ -->
  <link rel="icon" type="image/x-icon" href="data:;base64,iVBORw0KGgo=">

  <style>
    :root {
      --bg1:#0b0710; --bg2:#14050a; --accent:#ff6a00; --muted:#a7a0a8; --card:rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Noto Sans KR','Apple SD Gothic Neo','Malgun Gothic',sans-serif;margin:0;color:#eee;background:linear-gradient(180deg,var(--bg1),var(--bg2));}
    header{padding:20px;text-align:center;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(0,0,0,0.06));box-shadow:0 6px 30px rgba(0,0,0,0.5)}
    header h1{margin:0;color:var(--accent)}
    header .sub{color:var(--muted);font-size:13px;margin-top:6px}
    nav{display:flex;gap:10px;justify-content:center;padding:10px;background:#14141a;position:sticky;top:0;z-index:2}
    nav button{background:#1a1a22;border:1px solid #232532;color:#ddd;padding:10px 14px;border-radius:10px;cursor:pointer}
    nav button.active{background:var(--accent);color:#111}
    main{max-width:1100px;margin:18px auto;padding:0 16px}
    section{display:none}
    section.active{display:block}
    .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);margin-bottom:16px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px 10px;border-bottom:1px solid rgba(255,255,255,0.06);text-align:center}
    th{color:var(--muted);font-size:12px;text-transform:uppercase}
    tr:hover{background:rgba(255,255,255,0.03)}
    .tier-Stone{color:#8b8b8b}.tier-Bronze{color:#cd7f32}.tier-Silver{color:#c0c0c0}.tier-Gold{color:#ffd700}.tier-Diamond{color:#67e8f9}.tier-Legend{color:#ff7f50}
    .muted{color:var(--muted)}
    .filters{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
    .filters>*{flex:1 1 160px}
    .match{border:1px solid rgba(255,255,255,0.08);padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);margin-bottom:10px}
    .match-header{font-weight:700;margin-bottom:6px;cursor:pointer;color:#ffb347}
    .match-item{color:#ddd;font-size:14px;margin:4px 0;padding-left:8px}
    .hidden{display:none;}

    /* âœ… ìƒëŒ€ ì „ì  ì¡°íšŒ: ì…ë ¥ ì•„ë˜ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ */
    .h2h-input-wrap{flex:1 1 220px; min-width:220px}
    .h2h-suggest{
      margin-top:8px;
      border:1px solid rgba(255,255,255,0.10);
      border-radius:10px;
      background:rgba(0,0,0,0.18);
      overflow:hidden;
      display:none;
    }
    .h2h-suggest .item{
      padding:10px 12px;
      cursor:pointer;
      color:#ddd;
      border-bottom:1px solid rgba(255,255,255,0.06);
      font-size:14px;
    }
    .h2h-suggest .item:last-child{border-bottom:none;}
    .h2h-suggest .item:hover{background:rgba(255,255,255,0.06)}
    .h2h-suggest .empty{
      padding:10px 12px;
      color:#aaa;
      font-size:13px;
    }
  </style>
</head>

<body>
  <header>
    <h1>RockClan Records</h1>
    <div class="sub">í´ëœì› ë­í‚¹ â€¢ ê¸°ë¡ì‹¤ â€¢ ELO ì‹œìŠ¤í…œ ì„¤ëª… â€¢ ìƒëŒ€ ì „ì  ì¡°íšŒ</div>
  </header>

  <nav>
    <button class="tab active" data-tab="players">í´ëœì› ë­í‚¹</button>
    <button class="tab" data-tab="records">ê¸°ë¡ì‹¤</button>
    <button class="tab" data-tab="elo-info">ELO ì‹œìŠ¤í…œ ì„¤ëª…</button>
    <button class="tab" data-tab="h2h">ìƒëŒ€ ì „ì  ì¡°íšŒ</button>
  </nav>

<!-- ğŸ”¹ í”Œë ˆì´ì–´ íˆìŠ¤í† ë¦¬ íŒì—… -->
<div id="playerModal" class="modal" style="position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.6);padding-top:60px;display:none;">
  <div class="modal-content" style="background:#1a1a22;margin:auto;padding:20px;border-radius:12px;width:85%;max-height:80%;overflow-y:auto;color:#eee;box-shadow:0 0 20px rgba(0,0,0,.6)">
    <span id="closeModal" class="close" style="float:right;font-size:28px;cursor:pointer;color:#aaa">&times;</span>
    <h2 id="modalPlayerName" style="color:#ff6a00;margin-top:0;"></h2>
    <div id="modalPlayerInfo" style="font-size:14px;margin-bottom:12px;color:#ccc;"></div>
    <canvas id="modalEloChart" width="600" height="250" style="background:#111;border-radius:8px;margin-bottom:16px;"></canvas>
    <div id="modalMatchHistory" style="font-size:14px;color:#ddd;"></div>
  </div>
</div>

  <main>
    <!-- ë­í‚¹ -->
    <section id="players" class="active">
      <div class="card">
        <h2 style="margin:6px 0;color:var(--accent)">í´ëœì› ë­í‚¹</h2>
        <div class="filters">
          <input id="search" placeholder="ID ê²€ìƒ‰" style="padding:10px;border-radius:8px;border:1px solid #2c2f3a;background:#101018;color:#fff;">
          <select id="raceFilter" style="padding:10px;border-radius:8px;border:1px solid #2c2f3a;background:#101018;color:#fff;">
            <option value="">ì¢…ì¡± ì „ì²´</option>
            <option>Protoss</option><option>Terran</option><option>Zerg</option><option>Random</option>
          </select>
          <select id="tierFilter" style="padding:10px;border-radius:8px;border:1px solid #2c2f3a;background:#101018;color:#fff;">
            <option value="">í‹°ì–´ ì „ì²´</option>
            <option>Stone</option><option>Bronze</option><option>Silver</option><option>Gold</option><option>Diamond</option><option>Legend</option>
          </select>
        </div>
        <div class="muted" style="font-size:13px;margin-bottom:6px">í˜„ì¬ ELO ìˆœì„œ ê¸°ì¤€</div>
        <table id="players-table">
          <thead><tr><th>Rank</th><th>ID</th><th>ì¢…ì¡±</th><th>í‹°ì–´</th><th>ELO</th><th>ìŠ¹</th><th>íŒ¨</th><th>ìŠ¹ë¥ </th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- ê¸°ë¡ì‹¤ -->
    <section id="records">
      <div class="card">
        <h2 style="margin:6px 0;color:var(--accent)">ê¸°ë¡ì‹¤</h2>
        <div id="records-months" class="filters" style="margin-bottom:10px;"></div>
        <div id="match-list"></div>
      </div>
    </section>

    <!-- ELO ì„¤ëª… (ì›ë³¸ ìŠ¤íƒ€ì¼ ìœ ì§€) -->
<section id="elo-info">
  <div class="card">
    <h2 style="margin:6px 0;color:var(--accent)">ELO ì‹œìŠ¤í…œ ì„¤ëª…</h2>

    <p style="line-height:1.6;color:#ddd">
      RockClanì˜ ELO ì‹œìŠ¤í…œì€ ë‹¨ìˆœí•œ ì ìˆ˜ ì°¨ì´ë¿ ì•„ë‹ˆë¼ <b>í‹°ì–´(Tier) ë³´ì •</b>ì„ í¬í•¨í•˜ì—¬ ì‹¤ì œ ì‹¤ë ¥ ê²©ì°¨ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.<br>
      ëª¨ë“  ê³„ì‚°ì€ ê¸°ë¡ì‹¤(match) ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìˆ˜í–‰ë©ë‹ˆë‹¤.
    </p>

    <ul style="line-height:1.8;color:#ccc;margin-left:12px">
      <li><b>ì´ˆê¸° ELO</b>: ì‹ ê·œ í”Œë ˆì´ì–´ëŠ” 1000ì ìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.</li>
      <li><b>K ê°’</b>:
        <ul>
          <li>ê°œì¸ì „(1:1): <b>K = 12</b></li>
          <li>íŒ€ì „(2:2, 3:3, 4:4 ë“±): <b>K = 8</b></li>
        </ul>
      </li>
      <li><b>í‹°ì–´ ì¸ë±ìŠ¤ ë³´ì •</b>:
        <ul>
          <li>Stone=0, Bronze=1, Silver=2, Gold=3, Diamond=4, Legend=5</li>
          <li>ì‹¤ì œ ê³„ì‚°ì€ <code>EffectiveElo = ELO + (TierIndex Ã— 40)</code> ìœ¼ë¡œ ìˆ˜í–‰ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>ì˜ˆìƒ ìŠ¹ë¥ ì€ ë‘ í”Œë ˆì´ì–´ì˜ <b>EffectiveElo</b> ì°¨ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.</li>
      <li>ê²½ê¸° ê²°ê³¼ëŠ” ì˜ˆìƒ ìŠ¹ë¥  ëŒ€ë¹„ ì‹¤ì œ ìŠ¹íŒ¨ ì°¨ì´ë§Œí¼ ELOê°€ ë³€ë™í•©ë‹ˆë‹¤.</li>
    </ul>

    <h3 style="margin-top:16px;color:var(--accent)">ğŸ“ˆ ELO ê³„ì‚° ì˜ˆì‹œ</h3>
    <table style="width:100%;border-collapse:collapse;margin-top:8px;font-size:14px;color:#ddd">
      <thead>
        <tr style="background:rgba(255,255,255,0.05)">
          <th style="padding:6px;border:1px solid rgba(255,255,255,0.1)">ìƒí™©</th>
          <th style="padding:6px;border:1px solid rgba(255,255,255,0.1)">ELO ì°¨ì´</th>
          <th style="padding:6px;border:1px solid rgba(255,255,255,0.1)">í‹°ì–´ ì°¨ì´</th>
          <th style="padding:6px;border:1px solid rgba(255,255,255,0.1)">ì˜ˆìƒ ìŠ¹ë¥ </th>
          <th style="padding:6px;border:1px solid rgba(255,255,255,0.1)">ìŠ¹ë¦¬ ì‹œ</th>
          <th style="padding:6px;border:1px solid rgba(255,255,255,0.1)">íŒ¨ë°° ì‹œ</th>
        </tr>
      </thead>
      <tbody>
        <tr><td style="padding:6px;border:1px solid rgba(255,255,255,0.1)">1:1 (ë™í‹°ì–´, ë™ì¼ ELO)</td><td>0</td><td>0</td><td>50%</td><td>+6</td><td>âˆ’6</td></tr>
        <tr><td style="padding:6px;border:1px solid rgba(255,255,255,0.1)">Silver(2) vs Gold(3)</td><td>0</td><td>+1</td><td>46%</td><td>+7</td><td>âˆ’5</td></tr>
        <tr><td style="padding:6px;border:1px solid rgba(255,255,255,0.1)">Gold(3) vs Silver(2)</td><td>0</td><td>âˆ’1</td><td>54%</td><td>+5</td><td>âˆ’7</td></tr>
        <tr><td style="padding:6px;border:1px solid rgba(255,255,255,0.1)">íŒ€ì „ (í‰ê·  ë™í‹°ì–´)</td><td>0</td><td>0</td><td>50%</td><td>+4</td><td>âˆ’4</td></tr>
        <tr><td style="padding:6px;border:1px solid rgba(255,255,255,0.1)">íŒ€ì „ (ìƒëŒ€íŒ€ í‰ê·  Diamondâ†‘)</td><td>âˆ’150</td><td>+2</td><td>32%</td><td>+6</td><td>âˆ’3</td></tr>
      </tbody>
    </table>

    <p style="margin-top:10px;color:#999">
      â€» ELO ê³„ì‚°ì‹: <code>NewElo = OldElo + K Ã— (Actual âˆ’ Expected)</code><br>
      â€» í‹°ì–´ ì¸ë±ìŠ¤ ë³´ì •ìœ¼ë¡œ ì¸í•´ ìƒìœ„ í‹°ì–´ë¥¼ ì´ê¸¸ ê²½ìš° ìƒìŠ¹í­ì´ ë” ì»¤ì§‘ë‹ˆë‹¤.
    </p>

    <!-- ğŸ”¹ ì‹œë®¬ë ˆì´í„° -->
    <h3 style="margin-top:30px;color:var(--accent)">ğŸ§® ELO ê³„ì‚° ì‹œë®¬ë ˆì´í„°</h3>
    <div style="color:#ddd;font-size:14px;line-height:1.8;">
      <div style="display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:10px;">
        <label>í”Œë ˆì´ì–´ A ELO <input id="eloA" type="number" value="1000" style="width:80px;margin-left:6px;padding:4px;background:#111;border:1px solid #333;color:#fff;"></label>
        <label>í‹°ì–´
          <select id="tierA" style="padding:4px;background:#111;border:1px solid #333;color:#fff;">
            <option>Stone</option><option>Bronze</option><option selected>Silver</option><option>Gold</option><option>Diamond</option><option>Legend</option>
          </select>
        </label>
        <span style="margin:0 12px;">vs</span>
        <label>í”Œë ˆì´ì–´ B ELO <input id="eloB" type="number" value="1000" style="width:80px;margin-left:6px;padding:4px;background:#111;border:1px solid #333;color:#fff;"></label>
        <label>í‹°ì–´
          <select id="tierB" style="padding:4px;background:#111;border:1px solid #333;color:#fff;">
            <option>Stone</option><option>Bronze</option><option>Silver</option><option selected>Gold</option><option>Diamond</option><option>Legend</option>
          </select>
        </label>
        <label style="margin-left:16px;">ê²½ê¸° íƒ€ì…
          <select id="gameType" style="padding:4px;background:#111;border:1px solid #333;color:#fff;">
            <option value="1v1" selected>1:1</option>
            <option value="team">íŒ€ì „</option>
          </select>
        </label>
        <button id="calcBtn" style="margin-left:12px;padding:6px 12px;border:none;border-radius:6px;background:var(--accent);color:#111;cursor:pointer;">ê³„ì‚°</button>
      </div>

      <div id="simResult" style="margin-top:10px;padding:10px;border:1px solid rgba(255,255,255,0.1);border-radius:8px;background:rgba(255,255,255,0.03);">
        ê³„ì‚° ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
      </div>
    </div>

    <script>
      document.getElementById("calcBtn").addEventListener("click",()=>{
        const getTierIndex=t=>["Stone","Bronze","Silver","Gold","Diamond","Legend"].indexOf(t);
        const eloA=parseFloat(document.getElementById("eloA").value||1000);
        const eloB=parseFloat(document.getElementById("eloB").value||1000);
        const tierA=document.getElementById("tierA").value;
        const tierB=document.getElementById("tierB").value;
        const gameType=document.getElementById("gameType").value;
        const K=(gameType==="team")?8:12;

        const effA=eloA+getTierIndex(tierA)*40;
        const effB=eloB+getTierIndex(tierB)*40;
        const expectedA=1/(1+Math.pow(10,(effB-effA)/400));
        const deltaWin = K*(1-expectedA);
        const deltaLose = -K*(expectedA);
        const winPct=(expectedA*100).toFixed(1);

        document.getElementById("simResul
